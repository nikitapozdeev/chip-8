(()=>{"use strict";var t={284:(t,e,i)=>{i.r(e)},734:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=i(79),r=s(i(607)),n=s(i(573)),h=document.getElementById("chip8");if(!h)throw new Error("Canvas not found");var a=h.getContext("2d");if(!a)throw new Error("Cant get 2d context");var d="#CADC9F";h.width=640,h.height=320,a.fillStyle=d,a.fillRect(0,0,h.width,h.height),a.scale(10,10);var c=function(){function t(){this.ram=new Uint8Array(4096),this.video=this.createVideo(),this.V=new Uint8Array(16),this.stack=new Uint16Array(16),this.I=0,this.PC=512,this.SP=-1,this.DT=0,this.ST=0,this.speed=10,this.running=!1,this.speaker=new n.default,this.keyboard=new r.default,this.loadFont()}return t.prototype.createVideo=function(){for(var t=[],e=0;e<32;e++){for(var i=[],s=0;s<64;s++)i[s]=0;t.push(i)}return t},t.prototype.loadFont=function(){for(var t=0;t<o.FONT_SPRITES.length;t++)this.ram[t]=o.FONT_SPRITES[t]},t.prototype.draw=function(){for(var t=0;t<32;t++)for(var e=0;e<64;e++)1===this.video[t][e]?a.fillStyle="#306230":a.fillStyle=d,a.fillRect(e,t,1,1)},t.prototype.start=function(){var t=this;this.running=!0,console.log("power on");var e=1e3/60,i=null,s=function(o){i&&(o-i).toFixed(2)>=e.toFixed(2)&&t.tick(),i=o,window.requestAnimationFrame(s)};window.requestAnimationFrame(s)},t.prototype.tick=function(){for(var t=0;t<this.speed;++t)this.running&&this.processInstruction();this.running&&(this.updateTimers(),this.processAudio(),this.draw())},t.prototype.updateTimers=function(){this.DT>0&&this.DT--,this.ST>0&&this.ST--},t.prototype.processAudio=function(){this.ST>0?this.speaker.play():this.speaker.stop()},t.prototype.processInstruction=function(){var t=this.getOpCode(),e=4095&t,i=15&t,s=t>>8&15,o=t>>4&15,r=255&t;if(224===t)this.cls();else if(238===t)this.ret();else if(4096==(61440&t))this.jp(e);else if(8192==(61440&t))this.call(e);else if(12288==(61440&t))this.seVx(s,r);else if(16384==(61440&t))this.sneVx(s,r);else if(20480==(61440&t))this.seVxVy(s,o);else if(24576==(61440&t))this.ldVx(s,r);else if(28672==(61440&t))this.addVx(s,r);else if(32768==(61455&t))this.ldVxVy(s,o);else if(32769==(61455&t))this.orVxVy(s,o);else if(32770==(61455&t))this.andVxVy(s,o);else if(32771==(61455&t))this.xorVxVy(s,o);else if(32772==(61455&t))this.addVxVy(s,o);else if(32773==(61455&t))this.subVxVy(s,o);else if(32774==(61455&t))this.shrVx(s);else if(32775==(61455&t))this.subnVxVy(s,o);else if(32782==(61455&t))this.shlVx(s);else if(36864==(61455&t))this.sneVxVy(s,o);else if(40960==(61440&t))this.ld(e);else if(45056==(61440&t))this.jpV0(e);else if(49152==(61440&t))this.rndVx(s,r);else if(53248==(61440&t))this.drwVxVy(s,o,i);else if(57502==(61695&t))this.skpVx(s);else if(57505==(61695&t))this.sknpVx(s);else if(61447==(61695&t))this.ldVxDt(s);else if(61450==(61695&t))this.ldVxK(s);else if(61461==(61695&t))this.ldDtVx(s);else if(61464==(61695&t))this.ldStVx(s);else if(61470==(61695&t))this.addIVx(s);else if(61481==(61695&t))this.ldFVx(s);else if(61491==(61695&t))this.ldBVx(s);else if(61525==(61695&t))this.ldIVx(s);else{if(61541!=(61695&t))throw new Error("unknown command "+t.toString(16).padStart(4,"0"));this.ldVxI(s)}},t.prototype.sys=function(t){this.PC=t},t.prototype.cls=function(){this.video=this.createVideo()},t.prototype.ret=function(){if(-1===this.SP)throw new Error("Stack underflow");this.PC=this.stack[this.SP],this.SP--},t.prototype.jp=function(t){this.PC=t},t.prototype.call=function(t){if(this.SP++,this.SP>this.stack.length)throw new Error("Stack overflow");this.stack[this.SP]=this.PC,this.PC=t},t.prototype.seVx=function(t,e){this.V[t]===e&&(this.PC+=2)},t.prototype.sneVx=function(t,e){this.V[t]!==e&&(this.PC+=2)},t.prototype.seVxVy=function(t,e){this.V[t]===this.V[e]&&(this.PC+=2)},t.prototype.ldVx=function(t,e){this.V[t]=e},t.prototype.addVx=function(t,e){this.V[t]+=e},t.prototype.ldVxVy=function(t,e){this.V[t]=this.V[e]},t.prototype.orVxVy=function(t,e){this.V[t]|=this.V[e]},t.prototype.andVxVy=function(t,e){this.V[t]&=this.V[e]},t.prototype.xorVxVy=function(t,e){this.V[t]^=this.V[e]},t.prototype.addVxVy=function(t,e){this.V[t]+=this.V[e],this.V[t]>255?(this.V[t]&=255,this.V[15]=1):this.V[15]=0},t.prototype.subVxVy=function(t,e){this.V[t]>this.V[e]?this.V[15]=1:this.V[15]=0,this.V[t]-=this.V[e]},t.prototype.shrVx=function(t){255&~this.V[t]?this.V[15]=0:this.V[15]=1,this.V[t]=this.V[t]>>1},t.prototype.subnVxVy=function(t,e){this.V[e]>this.V[t]?this.V[15]=1:this.V[15]=0,this.V[e]-=this.V[t]},t.prototype.shlVx=function(t){65280&~this.V[t]?this.V[15]=0:this.V[15]=1,this.V[t]=this.V[t]<<1},t.prototype.sneVxVy=function(t,e){this.V[t]!==this.V[e]&&(this.PC+=2)},t.prototype.ld=function(t){this.I=t},t.prototype.jpV0=function(t){this.PC=t+this.V[0]},t.prototype.rndVx=function(t,e){var i=Math.ceil(256*Math.random());this.V[t]=i&e},t.prototype.drwVxVy=function(t,e,i){t=this.V[t],e=this.V[e];for(var s=!1,o=this.ram.slice(this.I,this.I+i),r=0;r<o.length;r++)for(var n=o[r].toString(2).padStart(8,"0").split("").map(Number),h=0;h<n.length;h++){var a=e+r,d=t+h,c=this.video[a%32][d%64]^n[h];1===this.video[a%32][d%64]&&0===c&&(s=!0),this.video[a%32][d%64]=c,this.V[15]=s?1:0}},t.prototype.skpVx=function(t){var e=this.V[t];this.keyboard.isKeyPressed(e)&&(this.PC+=2)},t.prototype.sknpVx=function(t){var e=this.V[t];this.keyboard.isKeyPressed(e)||(this.PC+=2)},t.prototype.ldVxDt=function(t){this.V[t]=this.DT},t.prototype.ldVxK=function(t){var e=this;this.running=!1,this.keyboard.waitForKeyPress((function(i){e.V[t]=i,e.running=!0}))},t.prototype.ldDtVx=function(t){this.DT=this.V[t]},t.prototype.ldStVx=function(t){this.ST=this.V[t]},t.prototype.addIVx=function(t){this.I+=this.V[t]},t.prototype.ldFVx=function(t){this.I=5*this.V[t]},t.prototype.ldBVx=function(t){var e=this.V[t],i=Math.floor(e/100);e-=100*i;var s=Math.floor(e/10);e-=10*s;var o=Math.floor(e);this.ram[this.I]=i,this.ram[this.I+1]=s,this.ram[this.I+2]=o},t.prototype.ldIVx=function(t){for(var e=0;e<=t;e++)this.ram[this.I+e]=this.V[e]},t.prototype.ldVxI=function(t){for(var e=0;e<=t;e++)this.V[e]=this.ram[this.I+e]},t.prototype.getOpCode=function(){return this.ram[this.PC++]<<8|this.ram[this.PC++]},t.prototype.load=function(t){for(var e=0;e<t.byteLength;e++)this.ram[this.PC+e]=t[e]},t}();e.default=c},79:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FONT_SPRITES=void 0,e.FONT_SPRITES=[240,144,144,144,240,32,96,32,32,112,240,16,240,128,240,240,16,240,16,240,144,144,240,16,16,240,128,240,16,240,240,128,240,144,240,240,16,32,64,64,240,144,240,144,240,240,144,240,16,240,240,144,240,144,144,224,144,224,144,224,240,128,128,128,240,224,144,144,144,224,240,128,240,128,240,240,128,240,128,128]},156:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=s(i(734)),r=i(185),n=s(i(110));i(284);var h,a,d=function(t){return t instanceof HTMLElement};h=n.default.map((function(t){return"<div class='rom' data-key='".concat(t,"'>").concat(t,"</div>")})).join(""),(a=document.getElementById("roms"))&&(a.insertAdjacentHTML("beforeend",h),a.addEventListener("click",(function(t){var e,i,s=t.target;if(d(s)&&s.classList.contains("rom")){var r=s.getAttribute("data-key");r&&(e=r,i=new o.default,fetch("./roms/".concat(e,".ch8")).then((function(t){return t.arrayBuffer()})).then((function(t){return new Uint8Array(t)})).then((function(t){i.load(t),i.start()})))}}))),function(){var t=document.getElementById("keyboard");if(t){var e="keyboard__key",i="data-key";t.addEventListener("mousedown",(function(t){var s=t.target;if(d(s)&&s.classList.contains(e)){var o=s.getAttribute(i);o&&(0,r.createKeyboardEvent)("keydown",o.charCodeAt(0))}})),t.addEventListener("mouseup",(function(t){var s=t.target;if(d(s)&&s.classList.contains(e)){var o=s.getAttribute(i);o&&(0,r.createKeyboardEvent)("keyup",o.charCodeAt(0))}}))}}()},607:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){var t=this;this.keyMap={49:1,50:2,51:3,52:12,81:4,87:5,69:6,82:13,65:7,83:8,68:9,70:14,90:10,88:0,67:11,86:15},this.pressedKeys=new Set,this.waitForKeyPressCallback=null,this.subscribeToEvents=function(){window.addEventListener("keydown",t.onKeyDownEvent.bind(t)),window.addEventListener("keyup",t.onKeyUpEvent.bind(t))},this.subscribeToEvents()}return t.prototype.onKeyDownEvent=function(t){var e=t.keyCode,i=this.keyMap[e];i&&(this.pressedKeys.add(i),this.waitForKeyPressCallback&&(this.waitForKeyPressCallback(i),this.waitForKeyPressCallback=null))},t.prototype.onKeyUpEvent=function(t){var e=t.keyCode,i=this.keyMap[e];i&&this.pressedKeys.has(i)&&this.pressedKeys.delete(i)},t.prototype.isKeyPressed=function(t){return this.pressedKeys.has(t)},t.prototype.waitForKeyPress=function(t){this.waitForKeyPressCallback=t},t}();e.default=i},573:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){this.context=new(window.AudioContext||window.webkitAudioContext),this.oscillator=this.context.createOscillator(),this.oscillator.connect(this.context.destination),this.isStarted=!1}return t.prototype.play=function(){this.isStarted?this.context.resume():(this.oscillator.frequency.setTargetAtTime(440,this.context.currentTime,0),this.oscillator.start(0),this.isStarted=!0)},t.prototype.stop=function(){this.context.suspend()},t}();e.default=i},185:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createKeyboardEvent=void 0,e.createKeyboardEvent=function(t,e){var i=new KeyboardEvent(t,{keyCode:e});window.dispatchEvent(i)}},110:t=>{t.exports=JSON.parse('["BMP Viewer - Hello (C8 example) [Hap, 2005]","Breakout (Brix hack) [David Winter, 1997]","Brick (Brix hack, 1990)","Brix [Andreas Gustafsson, 1990]","Chip8 emulator Logo [Garstyciuks]","Clock Program [Bill Fisher, 1981]","Delay Timer Test [Matthew Mikolay, 2010]","Division Test [Sergey Naydenov, 2010]","IBM Logo","Landing","Life [GV Samways, 1980]","Lunar Lander (Udo Pernisz, 1979)","Maze (alt) [David Winter, 199x]","Maze [David Winter, 199x]","Particle Demo [zeroZshadow, 2008]","Random Number Test [Matthew Mikolay, 2010]","Stars [Sergey Naydenov, 2010]","anEveningToDieFor","chip8-picture","chip8-test-rom-with-audio","chip8-test-rom","octojam1title","octojam2title","octopeg","pong","superneatboy","test_opcode"]')}},e={};function i(s){var o=e[s];if(void 0!==o)return o.exports;var r=e[s]={exports:{}};return t[s].call(r.exports,r,r.exports,i),r.exports}i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i(156)})();